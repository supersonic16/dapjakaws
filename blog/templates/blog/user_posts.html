{% extends "base.html" %}
{% block body %}
{% load static from static %}
<body>
<div class="container" style="margin-top: -3px;">
  <div class="row">
    <div class="col-lg-2 col-md-1"></div>
    <div class="col-lg-8 col-md-10 col-sm-12 bg-white">
      <div class="twPc-div">
        <a class="twPc-bg twPc-block"></a>
        {% if request.user != user %}
        <div class="twPc-button">
          <a href="" class="font-weight-normal btn btn-info followButton" style="font-size: 15px;"><span id="button_text">{{ button_text }}</span></a>
        </div>
        {% endif %}
        <div>


        <a title="" href="" class="twPc-avatarLink">
          <img src="{{ user.profile.image.url }}" class="account-img-custom">
        </a>
        <div class="twPc-divUser">
         <p class="p-0 mb-0">{{ user.first_name }}</p>
        <a href="">@<span>{{ user }}</span></a>
      </div>
      </div>


  <div class="container-fluid pt-2">
    <div class="row my-2">
    <div class="twPc-ArrangeSizeFit col-4">
      <a href="">
        <span class="twPc-StatLabel twPc-block">Posts</span>
        <span class="twPc-StatValue">{{ count }}</span>
      </a>
    </div>
    <div class="twPc-ArrangeSizeFit col-4">
      <a href="">
        <span class="twPc-StatLabel twPc-block">Following</span>
        <span class="twPc-StatValue">{{ following }}</span>
      </a>
    </div>
    <div class="twPc-ArrangeSizeFit col-4">
      <a href="">
        <span class="twPc-StatLabel twPc-block">Followers</span>
        <span class="twPc-StatValue" id="followers_count">{{ followers }}</span>
      </a>
    </div>
  </div>
</div>
  </div>
  <!--  -->
    <div class="container-fluid bg-white m-0 p-0">
    <!-- Jumbotron -->
    {% for post in posts %}
      <div class="container-fluid border p-0 mt-3  mb-2">
        <br>
        <div class="row">
          <div class="container text-justify" >
            <h3 class="h3 px-3">{{ post.title }}</h3>
            <h5 class="h5 text-muted px-3">{{ post.sub_title }}</h5>
            <div class="row pl-4 mt-4 mb-3 pb-3" style="display: flex; flex-wrap: wrap; margin-left: 1px;">
              <div class="pl-1" style="flex: 10%;">
              <img src="{{ post.author.profile.image.url }}" class="rounded-circle post-article-img">
              </div>
                <div class="pt-1 m-0" style="flex: 90%;">
                  <p class="post-detail-author p-0 m-0 ml-1">{{ post.author.first_name }}</p>
                  <a class="post-detail-author p-0 m-0 ml-1" href="#" style="font-weight: 400;">@{{ post.author }}</a>
                  <small class="text-muted">{{ post.date_posted|date:"M d" }}</small>
                </div>
            </div>
            <img src="{{ post.cover_image.url }}" class="jumbotron2">
          </div>
          <div class="container p-4 mx-2">
          <p class="text-justify text-wrap user-read-more">{{ post.content }}</p>
          <a href="{% url 'blog:post-detail' post.id %}">Read More</a>
          </div>
      </div>
    </div>
      {% endfor %}
  </div>
</div>
  <div class="col-lg-2 col-md-1"></div>
</div>
</div>

{% block javascript %}
  <script type="text/javascript">
  $(".followButton").click(function(event){
    event.preventDefault();
    $.ajax({
      url: '{% url 'followuser' user.id %}',
      dataType:  'json',
      success: function(result){
        if(result.login == 'f'){
        window.location.href = "/login/?next={{request.path}}";
          }
        else{
          $('#followers_count').text(result.followers);
          $('#button_text').text(result.button_text);
        }
      }
    })
  })
  </script>
{% endblock %}

</body>

{% endblock %}
